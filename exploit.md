## Nipah virus (NiV) – Testing Management System


**Bug Description:**

A Stored cross-site scripting (XSS) vulnerability in PHPGurukul Nipah virus (NiV) – Testing Management System 1.0 allows attackers to execute arbitrary web scripts via a crafted payload injected into the "Employee Id" and "Full Name" field.

**Steps to Reproduce:** 

```
# Exploit Title: Stored cross-site scripting (XSS) vulnerability in PHPGurukul Nipah virus (NiV) – Testing Management System
# Date: 30-11-2023
# Exploit Author: dhabaleshwardas
# Vendor Homepage: https://phpgurukul.com/
# Software Link: https://phpgurukul.com/nipah-virus-niv-testing-management-system-using-php-and-mysql/
# Version: 1.0
# Tested on: firefox/chrome/brave
# CVE : 
```


To reproduce the attack:

1- First login to the application then head to the http://localhost/nipah-tms/add-phlebotomist.php endpoint 

2- Then click on "Add Phlebotomist" then put any random data in "Employee Id" , "Full Name" and "Mobile Number" parameter.

<img width="698" alt="1" src="https://github.com/dhabaleshwar/niv_testing_sxss/assets/132373212/9ab6b7f6-b64a-41a6-b9a1-b5e7ed2e0a8d">


3- Then click on "Submit" and intercept the request. We then change the random values to payloads for XSS, in the "empid" parameter we put "><script>alert(3)</script> and in the "fullname" parameter we put "><script>alert(document.cookie)</script> the rest of
parameter we leave as it is.

<img width="713" alt="2" src="https://github.com/dhabaleshwar/niv_testing_sxss/assets/132373212/ecad7168-4f86-4af9-8ad4-01277c9d2cd1">


4- We then forward the request. We see in the browser that the payloads got executed, first the payload in the  "empid" parameter got executed displaying a "3" and then the payload in the "fullname" parameter got executed displaying the Cookie in the popup.

<img width="938" alt="3" src="https://github.com/dhabaleshwar/niv_testing_sxss/assets/132373212/8b589f31-c2d5-4165-bd27-e61f63566359">

<img width="944" alt="4" src="https://github.com/dhabaleshwar/niv_testing_sxss/assets/132373212/aa1dfd66-e18f-4f1a-9fee-578085152102">


5- Here, user input is directly embedded into the HTML content without proper sanitization or encoding. The strings "><script>alert(3)</script> and  "><script>alert(document.cookie)</script> is rendered as part of the HTML, making it vulnerable to script injection.

<img width="635" alt="5" src="https://github.com/dhabaleshwar/niv_testing_sxss/assets/132373212/a88d870a-8de6-4236-a065-df3a800b2cd2">


5- Stored XSS is a high severity vulnerability as, Attackers can steal sensitive information, such as login credentials, session tokens, or personal details, from users who unknowingly execute the malicious script. If a user with administrative privileges is affected, attackers can hijack their session, gaining unauthorized access to sensitive areas of a website or application.

**Remediation:** 

1-  Implement strict input validation on both the client and server sides. Validate and sanitize user input to ensure that it does not contain malicious code.

2- Encode user-generated content before rendering it in the browser. This helps to neutralize any malicious scripts and ensures that user input is treated as data, not executable code.
